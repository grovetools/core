#!/bin/bash
# Dynamic working directory setup for Claude sandbox

# Use environment variables with defaults
REPO_NAME=${GROVE_REPO:-grove}
BRANCH_NAME=${GROVE_BRANCH:-main}

# Create and change to the dynamic working directory
WORKDIR="/workspace/${REPO_NAME}/${BRANCH_NAME}"
mkdir -p "$WORKDIR"
cd "$WORKDIR"

# Set HOME to a dedicated sandbox directory for Claude config
export HOME="/home/claude-sandbox"

# The directory should already exist from Dockerfile, but ensure .claude subdirectory exists
mkdir -p "$HOME/.claude" 2>/dev/null || true

# Execute the command passed to the container
exec "$@"